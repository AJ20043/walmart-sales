--  CREATING DATABASE  --

CREATE DATABASE WALMART;
USE WALMART;

-- CREATING REFERANCE TABLE  --

CREATE TABLE REFERANCE(
	INVOICE_ID VARCHAR(30) PRIMARY KEY,
    BRANCH VARCHAR(5) NOT NULL,
    CITY VARCHAR(30) NOT NULL,
    CUSTOMER_TYPE VARCHAR(30) NOT NULL,
    GENDER VARCHAR(30) NOT NULL,
    PRODUCT_LINE VARCHAR(100) NOT NULL,
    UNIT_PRICE DECIMAL(10,2) NOT NULL,
    QUANTITY INT NOT NULL,
    5PERCENT_TAX FLOAT(6,4) NOT NULL,
    TOTAL DECIMAL(12, 4) NOT NULL,
    DATE DATE NOT NULL,
    TIME TIME NOT NULL,
    PAYMENT VARCHAR(15) NOT NULL,
    COGS DECIMAL(10,2) NOT NULL,
    GROSS_MARGIN_PERCENT FLOAT(11,9),
    GROSS_INCOME DECIMAL(12, 4),
    RATING FLOAT(2, 1)
);

--  DISPLAY ALL DATA FROM REFERANCE TABLE  --

SELECT * FROM REFERANCE;

--  SHOWING HOW MANY DATA ARE THERE IN MY TABLE  --
SELECT COUNT(*) FROM REFERANCE;

--  TIME_OF_DAY  --
SELECT BRANCH, CITY, TIME,
CASE
WHEN time BETWEEN "00:00:00" AND "12:00:00"
THEN "MORNING"
WHEN time BETWEEN "12:00:01" AND "16:00:00"
THEN "AFTERNOON"
ELSE "EVENING"
END AS TIME_OF_DAY
FROM REFERANCE;

--  ADDING EXTRA COLUMN  --

ALTER TABLE REFERANCE
ADD COLUMN TIME_OF_DAY varchar(20) AFTER TIME;

--  INSERTING VALUES  --

update REFERANCE set TIME_OF_DAY=CASE
WHEN TIME BETWEEN "00:00:00" AND "12:00:00"
THEN "Morning"
WHEN TIME BETWEEN "12:00:01" AND "16:00:00"
THEN "Afternoon"
ELSE "Evening"
END;

SELECT * FROM REFERANCE;

--  DAY_NAME  --

SELECT
	DATE,
	DAYNAME(DATE) AS DAY
FROM REFERANCE;

--  ADDING DAYNAME COLUMN  --

ALTER TABLE REFERANCE 
ADD COLUMN DAY  VARCHAR(15) AFTER TIME_OF_DAY;
UPDATE REFERANCE
SET DAY=DAYNAME(DATE);

--  ADDING MONTH COLUMN  --

SELECT DATE,MONTHNAME(DATE)
FROM REFERANCE;

ALTER TABLE REFERANCE
ADD MONTH VARCHAR(15) AFTER DAY;

UPDATE REFERANCE
SET MONTH=MONTHNAME(DATE);

SELECT * FROM REFERANCE;

-- SEPARATING REFERANCE TABLE  --

--  CUSTOMER TABLE  --
CREATE TABLE CUSTOMERS(
 CUST_ID INT PRIMARY KEY AUTO_INCREMENT,
 CUSTOMER_TYPE VARCHAR(30) NOT NULL,
 GENDER VARCHAR(30) NOT NULL
);

INSERT INTO CUSTOMERS(CUSTOMER_TYPE,GENDER) 
SELECT DISTINCT CUSTOMER_TYPE,GENDER 
FROM REFERANCE;
SELECT * FROM CUSTOMERS;


-- BRANCH TABLE  --
CREATE TABLE BRANCH(
BRANCH VARCHAR(3) NOT NULL,
CITY VARCHAR(30) NOT NULL
);

INSERT INTO BRANCH
SELECT DISTINCT BRANCH,CITY FROM REFERANCE
ORDER BY BRANCH;
SELECT * FROM BRANCH;

-- CREATING SALES TABLE  --
CREATE TABLE SALES
(INVOICE_ID VARCHAR(30) PRIMARY KEY,
CUST_ID INT NOT NULL,
BRANCH VARCHAR(3) NOT NULL
);



